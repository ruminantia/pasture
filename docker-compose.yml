services:
  pasture-scraper:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: ruminantia-pasture
    restart: unless-stopped
    volumes:
      - pastures:/app/output
      - ./config.ini:/app/config.ini:ro
    environment:
      - PYTHONPATH=/app
    stdin_open: true
    tty: true
    healthcheck:
      test:
        [
          "CMD",
          "python3",
          "-c",
          "import requests; requests.get('https://www.reddit.com/r/worldnews.json', timeout=30)",
        ]
      interval: 5m
      timeout: 30s
      retries: 3
      start_period: 2m
    networks:
      - pasture-network

volumes:
  pastures:
    driver: local

networks:
  pasture-network:
    driver: bridge
